<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org/">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Computer Networks">
    <title>Computer Networks</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
</head>

<body>
    <section class="header">
        <h1>Sensor data</h1>
    </section>
    <section>
        <h3>Total people in the building now:</h3>
        <div>
            <h3 id="val3"></h3>
        </div>
    </section>
    <section class="graph">
        <canvas id="myChart" style="width:100%;max-width:700px"></canvas>
        <div class="graphs">
        </div>
    </section>
    <section>
        <h4>Table over people passing</h4>
    </section>
    <section class="table-section">
            <table class="table" id="table">
                <tr>
                    <th>
                        Id
                    </th>
                    <th>
                        Date
                    </th>
                    <th>
                        Time
                    </th>
                    <th>
                        Total People
                    </th>
                </tr>
            </table>
    </section>
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="client.js"></script>
    <section>
        <span id="val"></span>
        <span id="val2"></span>

        <script th:inline="javascript">
                var table = document.getElementById("table"), sumVal = 0;
                var total = 0;
                for (var i = 1; i < table.rows.length; i++) {
                  sumVal = sumVal + parseInt(table.rows[i].cells[2].innerHTML);
                }
                for (var i = 1; i < table.rows.length; i++) {
                    total += parseInt(table.rows[i].cells[2].innerHTML);
                    }
                var avg = total / table.rows.length;
                console.log(avg);
                document.getElementById("val").innerHTML = "Total people passing in a day: " + sumVal;
                document.getElementById("val2").innerHTML = "Average people passing: " + avg;
                console.log(sumVal);


                var rows = document.getElementById("table").getElementsByTagName("tr");


              for(var i = 0; i < rows.length; i++)
                  { for (var j = 0; j < rows.length; j++) {
                    var first = parseInt(table.rows[i].cells[3].innerHTML);
                  }

                console.log("First: "+first);
                document.getElementById("val3").innerHTML = first;
              }
        </script>
    </section>

    <footer>
        <p class="info">
            This is a project in the course Data Communication and Network Programming at NTNU Ã…lesund.
        </p>
    </footer>
</body>